///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Imports
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const mongoose = require('mongoose');
const foodSchema = require('./Food');


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Document Schema for MongoDB
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const daySchema = new mongoose.Schema({
    userId:{
        type: String,
        unique: true,
        required: false
    },
    dayId: {
        type: String,
        required: true,
        unique: true
    },
    dayName: {
        type: String,
        required: true,
        lowercase: true,
        maxlength: [50, 'Game title can only be up to 50 characters']
    },
    foods: {
        type: [foodSchema.schema],
        required: false,
        default: []
    }
  });


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Static methods
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

daySchema.statics.findByUserId = async function(dayId) {
    return new Promise(async (resolve, reject) => {
        try {
            const day = this.findOne({dayId})
            resolve(day);
        } catch (err) {
            console.log(err)
            reject(`day with id: ${dayId} not found`);
        }
    });
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Exports
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const Day = mongoose.model('day', daySchema);

module.exports = Day;